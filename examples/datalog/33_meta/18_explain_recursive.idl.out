Connecting to server at http://127.0.0.1:8080...
Connected!

Server status: healthy
Authenticated as: admin
Current knowledge graph: default

> .kg create test_explain_recursive_n33t18
Knowledge graph 'test_explain_recursive_n33t18' created.
Switched to knowledge graph: test_explain_recursive_n33t18
> .kg use test_explain_recursive_n33t18
Switched to knowledge graph: test_explain_recursive_n33t18
> +edge[(1, 2), (2, 3)]
Inserted 2 fact(s) into 'edge'.
> +path(X, Y) <- edge(X, Y)
Rule 'path' registered.
> +path(X, Z) <- edge(X, Y), path(Y, Z)
Rule 'path' registered.
> .explain ?path(X, Y)
Query Plan:
═══════════════════════════════════════════════════════════
                    PIPELINE TRACE                          
═══════════════════════════════════════════════════════════

┌---------------------------------------------------------┐
| PARSING                                                 |
`---------------------------------------------------------┘
  Rules parsed: 3

  Rule 1: path(Variable("X"), Variable("Y")) <- edge(Variable("X"), Variable("Y"))
  Rule 2: path(Variable("X"), Variable("Z")) <- edge(Variable("X"), Variable("Y")), path(Variable("Y"), Variable("Z"))
  Rule 3: __query__(Variable("X"), Variable("Y")) <- path(Variable("X"), Variable("Y"))

┌---------------------------------------------------------┐
| IR CONSTRUCTION                                         |
`---------------------------------------------------------┘
  IR nodes: 7
  Rules: 2

  Rule 1 IR:
    Union (2 inputs)
    |- Input 1:
        Scan(edge)[X, Y]
    |- Input 2:
        Map[[0, 2]] -> [X, Z]
          Join[L:[1], R:[0]] -> [X, Y, Z]
          |- Left:
              Scan(edge)[X, Y]
          `- Right:
              Scan(path)[Y, Z]

  Rule 2 IR:
    Scan(path)[X, Y]

┌---------------------------------------------------------┐
| OPTIMIZATION                                            |
`---------------------------------------------------------┘
  IR nodes: 7 -> 8 (0 eliminated)

  Rule 1 Optimized IR:
    Distinct
      Join[L:[0, 2], R:[1, 0]] -> [Y, Z, X]
      |- Left:
          Distinct
            Join[L:[0], R:[1]] -> [Y, Z, X]
            |- Left:
                Scan(path)[Y, Z]
            `- Right:
                Scan(edge)[X, Y]
      `- Right:
          Scan(edge)[X, Y]

  Rule 2 Optimized IR:
    Scan(path)[X, Y]

═══════════════════════════════════════════════════════════


Optimization passes:
  - Join Planning (spanning tree reordering)
  - SIP Rewriting (semijoin reduction)
  - Subplan Sharing (common subexpression elimination)
  - Basic Optimizations (identity elimination, filter simplification)
> .kg use default
Switched to knowledge graph: default
> .kg drop test_explain_recursive_n33t18
Knowledge graph 'test_explain_recursive_n33t18' dropped.
