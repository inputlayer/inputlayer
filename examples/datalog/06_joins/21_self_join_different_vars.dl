% Test: Self-join with different variable names
% Expected: Find pairs from same relation
% Category: 06_joins
% Priority: P2 - Join patterns

.kg create test_self_join
.kg use test_self_join

+employees[(1, "Alice", 50000), (2, "Bob", 60000), (3, "Carol", 50000)].

% Find pairs with same salary
same_salary(N1, N2) :-
    employees(Id1, N1, Sal),
    employees(Id2, N2, Sal),
    Id1 < Id2.

?- same_salary(N1, N2).

.kg use default
.kg drop test_self_join
