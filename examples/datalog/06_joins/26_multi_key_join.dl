% Test: Join on multiple keys
% Expected: Both keys must match
% Category: 06_joins
% Priority: P2 - Join patterns

.kg create test_multi_key
.kg use test_multi_key

+left[(1, "a", 100), (2, "b", 200), (3, "a", 300)].
+right[(1, "a", "match1"), (2, "b", "match2"), (1, "b", "nomatch")].

% Join on both id and category
joined(Id, Cat, Val, Label) :- left(Id, Cat, Val), right(Id, Cat, Label).

?- joined(Id, Cat, Val, Label).

.kg use default
.kg drop test_multi_key
