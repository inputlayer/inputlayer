// Test: AVG of empty group

.kg create test_avg_empty_n14t17
.kg use test_avg_empty_n14t17

// Create empty relation
+values(id: int, amount: int)

// Try AVG on empty relation - should not crash/divide by zero
+avg_result(avg<Amount>) <- values(_, Amount)
?avg_result(Avg)

// Also test with WHERE clause that matches nothing
+data[(1, 100), (2, 200)]
+filtered_avg(avg<V>) <- data(Id, V), Id > 100
?filtered_avg(Avg)

.kg use default
.kg drop test_avg_empty_n14t17
