// Test: Drop and re-add all aggregation types
// Description: Tests that each aggregation type can be dropped and re-added cleanly

.kg create test_readd_all_n14t137
.kg use test_readd_all_n14t137

+data[(1, 10), (1, 20), (2, 30), (2, 40), (2, 50)]

// Define all agg types
+s(Grp, sum<V>) <- data(Grp, V)
+c(Grp, count<V>) <- data(Grp, V)
+mn(Grp, min<V>) <- data(Grp, V)
+mx(Grp, max<V>) <- data(Grp, V)
+av(Grp, avg<V>) <- data(Grp, V)

?s(X, Y)
?c(X, Y)
?mn(X, Y)
?mx(X, Y)
?av(X, Y)

// Drop all
.rule drop s
.rule drop c
.rule drop mn
.rule drop mx
.rule drop av

// Re-add all with same definitions
+s(Grp, sum<V>) <- data(Grp, V)
+c(Grp, count<V>) <- data(Grp, V)
+mn(Grp, min<V>) <- data(Grp, V)
+mx(Grp, max<V>) <- data(Grp, V)
+av(Grp, avg<V>) <- data(Grp, V)

// Results should be identical to before
?s(X, Y)
?c(X, Y)
?mn(X, Y)
?mx(X, Y)
?av(X, Y)

.kg use default
.kg drop test_readd_all_n14t137
