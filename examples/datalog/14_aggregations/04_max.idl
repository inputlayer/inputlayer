// Test: Max Aggregation
// Description: Tests max aggregation to find maximum value per group

.kg create test_agg_max_n14t04
.kg use test_agg_max_n14t04

// Insert temperature readings: reading(sensor_id, temperature)
+reading[(1, 25), (1, 22), (1, 28), (2, 30), (2, 35), (3, 18)]

// Find maximum temperature per sensor
+max_temp(Sensor, max<Temp>) <- reading(Sensor, Temp)

// Query the max result
?max_temp(X, Y)

// Cleanup
.kg use default
.kg drop test_agg_max_n14t04
