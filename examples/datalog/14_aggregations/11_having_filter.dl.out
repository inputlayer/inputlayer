
Executing script: /Users/samuel.picek/InputLayer/FlowLog/course/final-project/examples/datalog/14_aggregations/11_having_filter.dl

> .db create test_having
Database 'test_having' created.
Switched to database: test_having
> .db use test_having
Switched to database: test_having
> +orders[(1, 100), (1, 200), (1, 50), (2, 500), (2, 300), (3, 25), (3, 30), (3, 20), (4, 1000), (5, 100), (5, 100), (5, 100), (5, 100)].
Inserted 10 new fact(s) into 'orders' (3 duplicate(s) skipped).
> view customer_total(Customer: int, sum<Amount>: int) :- orders(Customer, Amount).
View 'customer_total' registered.
> ?- customer_total(C, T).
5 rows:
  (1, 350)
  (2, 800)
  (3, 75)
  (4, 1000)
  (5, 100)
> view big_spenders(Customer: int, Total: int) :- customer_total(Customer, Total), Total > 300.
View 'big_spenders' registered.
> ?- big_spenders(C, T).
3 rows:
  (1, 350)
  (2, 800)
  (4, 1000)
> view order_count(Customer: int, count<Amount>: int) :- orders(Customer, Amount).
View 'order_count' registered.
> ?- order_count(C, N).
5 rows:
  (1, 3)
  (2, 2)
  (3, 3)
  (4, 1)
  (5, 1)
> view frequent_buyers(Customer: int, Count: int) :- order_count(Customer, Count), Count > 2.
View 'frequent_buyers' registered.
> ?- frequent_buyers(C, N).
2 rows:
  (1, 3)
  (3, 3)
> view vip_customers(Customer: int) :- big_spenders(Customer, _), frequent_buyers(Customer, _).
View 'vip_customers' registered.
> ?- vip_customers(C).
No results.
> .db use default
Switched to database: default
> .db drop test_having
Database 'test_having' dropped.

