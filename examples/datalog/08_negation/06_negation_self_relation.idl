// Test: Negation on Same Relation (Self-Antijoin)
// Description: Tests negation where we exclude tuples from the same relation
// Find source nodes (nodes with outgoing edges but no incoming edges)

.kg create test_neg_self_n08t06
.kg use test_neg_self_n08t06

// Graph edges
+edge[(1, 2), (2, 3), (3, 4), (1, 3), (2, 4)]

// Extract all source nodes (nodes with outgoing edges)
+source_node(X, Y) <- edge(X, Y)

// Extract all target nodes (nodes that are destinations)
+target_node(Y, X) <- edge(X, Y)

// Find nodes that are sources but NOT targets (pure source nodes)
// A node X is a pure source if it has outgoing edges but no incoming edges
+pure_source(X, Y) <- source_node(X, Y), !target_node(X, _)

// Edges from pure sources: (1, 2), (1, 3)
?pure_source(X, Y)

// Cleanup
.kg use default
.kg drop test_neg_self_n08t06
