Executing script: examples/datalog/18_advanced_patterns/11_recursion_arithmetic_agg.dl

> .db create test_rec_arith_agg
Database 'test_rec_arith_agg' created.
Switched to database: test_rec_arith_agg
> .db use test_rec_arith_agg
Switched to database: test_rec_arith_agg
> +edge[(1, 2, 10), (2, 3, 20), (3, 4, 15), (1, 3, 50), (2, 4, 25)].
Inserted 5 facts into 'edge'.
> path_weight(X, Y, W) := edge(X, Y, W).
View 'path_weight' registered.
> path_weight(X, Z, W1+W2) := path_weight(X, Y, W1), edge(Y, Z, W2).
Rule added to view 'path_weight' (2 rules total).
> ?- path_weight(X, Y, W).
10 rows:
  (1, 2, 10)
  (1, 3, 30)
  (1, 3, 50)
  (1, 4, 35)
  (1, 4, 45)
  (1, 4, 65)
  (2, 3, 20)
  (2, 4, 25)
  (2, 4, 35)
  (3, 4, 15)
> min_path(X, Y, min<W>) := path_weight(X, Y, W).
View 'min_path' registered.
> ?- min_path(X, Y, W).
6 rows:
  (1, 2, 10)
  (1, 3, 30)
  (1, 4, 35)
  (2, 3, 20)
  (2, 4, 25)
  (3, 4, 15)
> path_count(X, Y, count<W>) := path_weight(X, Y, W).
View 'path_count' registered.
> ?- path_count(X, Y, C).
6 rows:
  (1, 2, 1)
  (1, 3, 2)
  (1, 4, 3)
  (2, 3, 1)
  (2, 4, 2)
  (3, 4, 1)
> total_from_1(sum<W>) := path_weight(1, _, W).
View 'total_from_1' registered.
> ?- total_from_1(T).
1 rows:
  (235)
> avg_from_1(avg<W>) := path_weight(1, _, W).
View 'avg_from_1' registered.
> ?- avg_from_1(A).
No results.
> .db use default
Switched to database: default
> .db drop test_rec_arith_agg
Database 'test_rec_arith_agg' dropped.
