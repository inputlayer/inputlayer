// Test: LAG function simulation

.kg create test_lag_n18t127
.kg use test_lag_n18t127

+data[(1, 100), (2, 150), (3, 120), (4, 180)]

// Find consecutive pairs (simulates LAG)
+consecutive(Id, Val, PrevVal) <-
    data(Id, Val),
    data(PrevId, PrevVal),
    PrevId = Id - 1

?consecutive(Id, Val, Prev)

.kg use default
.kg drop test_lag_n18t127
