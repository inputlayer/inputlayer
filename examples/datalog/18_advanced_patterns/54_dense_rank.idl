// Test: Dense rank simulation

.kg create test_dense_rank_n18t54
.kg use test_dense_rank_n18t54

+scores[("A", 100), ("B", 90), ("C", 100), ("D", 85)]

// Get distinct scores
+distinct_scores(min<Score>) <- scores(_, Score)

// Count distinct scores higher = rank
+dense_rank(Name, Score, <COUNT_DISTINCT:Higher>) <- scores(Name, Score), scores(_, Higher), Higher > Score

?dense_rank(Name, Score, Rank)

.kg use default
.kg drop test_dense_rank_n18t54
