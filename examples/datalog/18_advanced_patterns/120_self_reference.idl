// Test: Self-referential join

.kg create test_self_ref_n18t120
.kg use test_self_ref_n18t120

+employees[(1, "Alice", 0), (2, "Bob", 1), (3, "Carol", 1), (4, "Dave", 2)]

// Employee with manager name (self-join)
+with_manager(EmpName, MgrName) <-
    employees(EmpId, EmpName, MgrId),
    employees(MgrId, MgrName, _),
    MgrId > 0

?with_manager(E, M)

.kg use default
.kg drop test_self_ref_n18t120
